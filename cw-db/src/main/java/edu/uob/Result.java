package edu.uob;

import java.util.List;
import java.util.ArrayList;

// This class represents a successful result of a completed task.
// It stores the text to be displayed to user.
// It is generated by DBKeeper.
public class Result {
    private ArrayList<List<String>> tab;
    private ArrayList<Integer> columnWidth; // Used for vertical alignment

    public Result() {
        this.tab = new ArrayList<List<String>>();
        this.columnWidth = new ArrayList<Integer>();
    }

    public void addRow(List<String> row) {
        if (row == null) {
            return;
        }
        while (columnWidth.size() < row.size()) {
            columnWidth.add(0);
        }
        for (int col = 0; col < row.size(); ++col) {
            String str = row.get(col);
            if (str == null) {
                continue;
            }
            if (str.length() > columnWidth.get(col)) {
                columnWidth.set(col, str.length());
            }
        }
        this.tab.add(row); // `row` not copied
    }

    private String formatRow(List<String> row, String delim) {
        String str = "";
        for (int col = 0; col < row.size(); ++col) {
            if (col > 0) {
                str += delim;
            }
            String field = row.get(col);
            if (field == null) {
                field = "";
            }
            int width = columnWidth.get(col).intValue();
            str += field + " ".repeat(width - field.length());
        }
        return str;
    }

    public String exportToString() {
        return exportToString("  ");
    }

    public String exportToString(String delim) {
        String str = "";
        for (List<String> row : tab) {
            str += formatRow(row, delim) + "\n";
        }
        return str;
    }
}
